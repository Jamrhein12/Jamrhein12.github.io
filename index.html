<html>
<script src='https://cdn.jsdelivr.net/npm/d3@7'></script>
<body onload='init()'>

<h1>NBA vs. NCAA Shooting Percentages Data</h1>

<p>Below are charts showing shooting percentage data of players in the NBA (National Basketball Association)
    and their respective shooting percentage data of when they played college basketball (NCAA)</p>

<p>These specific players were selected because they all played college basketball, started their career in
    or after the year 2000, and averaged 20 points per game or more in their NBA career.
</p>

<p>Average data for the NBA was taken from data from NBA players who played in the year 2018
    (the most recent year of the data) and have played atleast 100 career games.
</p>

<div id="datacontainer"></div>

<div id="averages"></div>

<h1>NBA Shooting Percentages</h1>

<p>Blue = 3pt percentage<br>Orange = FG percentage</p>

<svg id="chart1" width="2000" height="750"></svg>

<br><br><br><br><br>

<h1>NCAA Shooting Percentages</h1>

<p>Green = 3pt percentage<br>Black = FG percentage</p>

<svg id="chart2" width="2000" height="750"></svg>

<br><br><br><br><br>

<h1>NBA/NCAA Shooting Percentages</h1>

<p>Blue = 3pt percentage (NBA)<br>Green = 3pt percentage (NCAA)
<br>Orange = FG percentage (NBA)<br>Black = FG percentage (NCAA)
</p>

<svg id="chart3" width="2000" height="750"></svg>

<script>

async function init() {

    const data = await d3.csv('https://Jamrhein12.github.io/players.csv');

    // Filter data to...
    // 1. Player played college basketball
    // 2. Player started career in or after 2000
    // 3. Player has a career nba ppg >= 20
    const filteredData = data.filter(row => 
        row.active_from >= 2000 && 
        row.college !== null && 
        row.college !== "" &&
        row.NBA_ppg >= 20.0);

    console.log(filteredData);

// Global chart dimensions

    const svgWidth = 2000;
    const svgHeight = 750;
    const margin = { top: 50, right: 50, bottom: 50, left: 50 };
    const chartWidth = svgWidth - margin.left - margin.right;
    const chartHeight = svgHeight - margin.top - margin.bottom;

//////////////////////////////////////////////
// NBA chart
//////////////////////////////////////////////

    const svg1 = d3.select('#chart1')
        .attr("width", svgWidth)
        .attr("height", svgHeight);

    const xScale1 = d3.scaleBand()
        .domain(filteredData.map(d => d.name))
        .range([margin.left, chartWidth + margin.left])
        .padding(0.1);

    const yScale1 = d3.scaleLinear()
    .domain([0, d3.max(filteredData, d => Math.max(d['NBA__3ptpct'], d['NBA_fg%']))])
    .range([chartHeight, 0]);

    const xAxis1 = d3.axisBottom(xScale1);
    const yAxis1 = d3.axisLeft(yScale1);

    svg1.append("g")
        .attr("transform", "translate(0, 700)")
        .call(xAxis1);

    svg1.append("g")
        .attr("transform", "translate(50, 0)")
        .call(yAxis1);

    svg1.selectAll(".group")
        .data(filteredData)
        .enter()
        .append("g")
        .attr("class", "group")
        .attr("transform", d => `translate(${xScale1(d.name)}, 0)`)
        .selectAll(".bar")
        .data(d => [d['NBA__3ptpct'], d['NBA_fg%']])
        .enter()
        .append("rect")
        .attr("class", "bar")
        .attr("x", (d, i) => i * (xScale1.bandwidth() / 2))
        .attr("y", d => yScale1(d))
        .attr("width", xScale1.bandwidth() / 2)
        .attr("height", d => chartHeight + margin.top - yScale1(d))
        .attr("fill", (d, i) => ["steelblue", "orange"][i]);


/////////////////////////////////////////////
// NCAA chart
/////////////////////////////////////////////

    const svg2 = d3.select('#chart2')
        .attr("width", svgWidth)
        .attr("height", svgHeight);

    const xScale2 = d3.scaleBand()
        .domain(filteredData.map(d => d.name))
        .range([margin.left, chartWidth + margin.left])
        .padding(0.1);

    const yScale2 = d3.scaleLinear()
    .domain([0, d3.max(filteredData, d => Math.max(d['NBA__3ptpct'], d['NBA_fg%']))])
    .range([chartHeight, 0]);

    const xAxis2 = d3.axisBottom(xScale2);
    const yAxis2 = d3.axisLeft(yScale2);

    svg2.append("g")
        .attr("transform", "translate(0, 700)")
        .call(xAxis2);

    svg2.append("g")
        .attr("transform", "translate(50, 0)")
        .call(yAxis2);

    svg2.selectAll(".group")
        .data(filteredData)
        .enter()
        .append("g")
        .attr("class", "group")
        .attr("transform", d => `translate(${xScale2(d.name)}, 0)`)
        .selectAll(".bar")
        .data(d => [d['NCAA__3ptpct'], d['NCAA_fgpct']])
        .enter()
        .append("rect")
        .attr("class", "bar")
        .attr("x", (d, i) => i * (xScale2.bandwidth() / 2))
        .attr("y", d => yScale2(d))
        .attr("width", xScale2.bandwidth() / 2)
        .attr("height", d => chartHeight + margin.top - yScale2(d))
        .attr("fill", (d, i) => ["green", "purple"][i]);

////////////////////////////////////////////////
// NBA / NCAA chart
///////////////////////////////////////////////

    const svg3 = d3.select('#chart3')
        .attr("width", svgWidth)
        .attr("height", svgHeight);

    const xScale3 = d3.scaleBand()
        .domain(filteredData.map(d => d.name))
        .range([margin.left, chartWidth + margin.left])
        .padding(0.1);

    const yScale3 = d3.scaleLinear()
    .domain([0, d3.max(filteredData, d => Math.max(d['NBA__3ptpct'], d['NBA_fg%']))])
    .range([chartHeight, 0]);

    const xAxis3 = d3.axisBottom(xScale3);
    const yAxis3 = d3.axisLeft(yScale3);

    svg3.append("g")
        .attr("transform", "translate(0, 700)")
        .call(xAxis3);

    svg3.append("g")
        .attr("transform", "translate(50, 0)")
        .call(yAxis3);

    svg3.selectAll(".group")
        .data(filteredData)
        .enter()
        .append("g")
        .attr("class", "group")
        .attr("transform", d => `translate(${xScale3(d.name)}, 0)`)
        .selectAll(".bar")
        .data(d => [d['NBA__3ptpct'], d['NCAA__3ptpct'], d['NBA_fg%'], d['NCAA_fgpct']])
        .enter()
        .append("rect")
        .attr("class", "bar")
        .attr("x", (d, i) => i * (xScale3.bandwidth() / 4))
        .attr("y", d => yScale3(d))
        .attr("width", xScale3.bandwidth() / 4)
        .attr("height", d => chartHeight + margin.top - yScale3(d))
        .attr("fill", (d, i) => ["steelblue", "green", "orange", "purple"][i]);

}

</script>
</body>
</html>
