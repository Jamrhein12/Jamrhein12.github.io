<html>
<script src='https://cdn.jsdelivr.net/npm/d3@7'></script>
<style> rect {fill: lightblue; stroke: black; }</style>
<body onload='init()'>

<h1>NBA vs. NCAA Shooting Percentages Data</h1>

<p>Below are charts showing shooting percentage data of players in the NBA (National Basketball Association)
    and their respective shooting percentage data of when they played college basketball (NCAA)</p>

<p>These specific players were selected because they all played college basketball, started their career in
    or after the year 2000, and averaged 20 points per game or more in their NBA career.
</p>

<div id="datacontainer"></div>

<div id="averages"></div>

<script>

async function init() {

    const data = await d3.csv('https://Jamrhein12.github.io/players.csv');

    // Filter data to...
    // 1. Player played college basketball
    // 2. Player started career in or after 2000
    // 3. Player has a career nba ppg >= 20
    const filteredData = data.filter(row => 
        row.active_from >= 2000 && 
        row.college !== null && 
        row.college !== "" &&
        row.NBA_ppg >= 20.0);

    console.log(filteredData);

    // Getting league averages
    const avg_nba_3ptapg = parseFloat(d3.mean(filteredData, d => +d['NBA__3ptapg']).toFixed(2));
    console.log(avg_nba_3ptapg);
    const avg_nba_3ptpct = parseFloat(d3.mean(filteredData, d => +d['NBA__3ptpct']).toFixed(2));
    console.log(avg_nba_3ptpct);
    const avg_nba_3ptpg = parseFloat(d3.mean(filteredData, d => +d['NBA__3ptpg']).toFixed(2));
    console.log(avg_nba_3ptpg);
    const avg_nba_efgpct = parseFloat(d3.mean(filteredData, d => +d['NBA_efgpct']).toFixed(2));
    console.log(avg_nba_efgpct);
    const avg_nba_fg = parseFloat(d3.mean(filteredData, d => +d['NBA_fg%']).toFixed(2));
    console.log(avg_nba_fg);
    const avg_nba_fg_per_game = parseFloat(d3.mean(filteredData, d => +d['NBA_fg_per_game']).toFixed(2));
    console.log(avg_nba_fg_per_game);
    const avg_nba_fga_per_game = parseFloat(d3.mean(filteredData, d => +d['NBA_fga_per_game']).toFixed(2));
    console.log(avg_nba_fga_per_game);
    const avg_nba_ft = parseFloat(d3.mean(filteredData, d => +d['NBA_ft%']).toFixed(2));
    console.log(avg_nba_ft);
    const avg_nba_ft_per_g = parseFloat(d3.mean(filteredData, d => +d['NBA_ft_per_g']).toFixed(2));
    console.log(avg_nba_ft_per_g);
    const avg_nba_fta_p_g = parseFloat(d3.mean(filteredData, d => +d['NBA_fta_p_g']).toFixed(2));
    console.log(avg_nba_fta_p_g);


    d3.select('#datacontainer')
        .selectAll('p')
        .data(filteredData)
        .enter()
        .append('p')
        .html(function(d, i) { console.log("Index:", i, "Value:", d.name); return 'Name: ' + d.name + ' Career PPG: ' + d.NBA_ppg; });

    d3.select('#averages')
        .append('p')
        .html('Avg. NBA 3pt attempts per game: ' + avg_nba_3ptapg +
              '<br>Avg. NBA 3pt percentage: ' + avg_nba_3ptpct +
              '<br>Avg. NBA 3pt per game: ' + avg_nba_3ptpg +
              '<br>Avg. NBA EFG pct: ' + avg_nba_efgpct +
              '<br>Avg. NBA FG percentage: ' + avg_nba_fg + 
              '<br>Avg. NBA FG per game: ' + avg_nba_fg_per_game +
              '<br>Avg. NBA FGA per game: ' + avg_nba_fga_per_game +
              '<br>Avg. NBA FT percentage: ' + avg_nba_ft +
              '<br>Avg. NBA FT per game: ' + avg_nba_ft_per_g +
              '<br>Avg. NBA FTA per game: ' + avg_nba_fta_p_g)

}

</script>
</body>
</html>
